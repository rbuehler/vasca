---
authors : "UC science"
comment : "Test configuration file"

general:
    name          : "CrabGW"
    out_dir_base  : "./vasca/test/out_pipe"                  # If "CWD" current work directory will be used.
    log_level       : "DEBUG"                                # ["NONE", "DEBUG", "INFO", "WARNING", "ERROR", "CRITICAL"]
    log_file        : "default"                              # Will be written into "out_dir", if ""default" a default name will be created 
    nr_cpus         : 2                                      # Number of CPUs to use. If "null" all available are used.
    save_ref_srcs   : false
    
ressources:                      
    load_method      : "MAST_LOCAL"                         # Allowed are ["MAST_REMOTE", "MAST_LOCAL", "VASCA", "AUTO"]
    load_products    : "TABLES"                                   # Get data products from MAST, if false only meta data is loaded
    field_kwargs:
        data_path        : null
        visits_data_path : null

cluster_src:
    meanshift:
        bandwidth     : 3                                    # In arcsec, to estimate it automatically specify "null"
        seeds         : null
        bin_seeding   : false
        min_bin_freq  : 1
        cluster_all   : true
        n_jobs        : 2
        max_iter      : 300
        table_name    : "tt_sources"

cluster_coadd_dets:
    meanshift:
        bandwidth     : 3               # In arcsec, to estimate it automatically specify "null"
        seeds         : null
        bin_seeding   : false
        min_bin_freq  : 1
        cluster_all   : true
        n_jobs        : 3
        max_iter      : 300
        table_name    : "tt_coadd_detections"
        
selection:
    src_quality:
        table    : "tt_sources"
        sel_type : "and"                                     # These are OR selections
        range:
            nr_det        : [1,.inf]          
    src_variability:
        table    : "tt_sources"
        sel_type : "and"
        range:        
            flux_cpval     : [-0.5,0.001]  
            pos_cpval      : [0.00000001,.inf] 
            flux_nxv       : [0.0006,.inf] 

    det_association : 
        table     : "tt_detections"
        ref_table : "tt_sources"
        sel_type  : "is_in"
        var       : "rg_src_id"
                    
observations:
  - observatory   : "GALEX"
    obs_filter    : "NUV"
    
    cluster_det:
        meanshift:
            bandwidth     : 5                               # In arcsec, to estimate it automatically specify "null"
            seeds         : null
            bin_seeding   : false
            min_bin_freq  : 1
            cluster_all   : true
            n_jobs        : null
            max_iter      : 300
            table_name    : "tt_detections"

    selection:
        det_quality:
            table    : "tt_detections"
            sel_type : "and"                                # These are all AND selections
            range:
                s2n            : [3.5,.inf]
                r_fov          : [0.0,0.55]
                point_src_prob : [0.5,1.0]
                bright_match   : [-0.5,0.5]
                mag            : [16,26]
            bitmask:
                artifacts : [2,4]
            set_range:
                pos_err : [0.5,5] # 1 arcsec = 0.0002777, 0.5 arcsec = 0.0001389
        coadd_det_quality:
            table    : "tt_coadd_detections"
            sel_type : "and"  # These are all AND selections
            range:
                s2n            : [3.5,.inf]
                r_fov          : [0.0,0.55]
        det_association : 
            table     : "tt_detections"
            ref_table : "tt_sources"
            sel_type  : "is_in"
            var       : "fd_src_id"
    obs_field_ids :
        - 6388191295067652096 # NGC4993-GW170817 2 visits
        - 6381787756527353856 # AIS_309_1_28 2 visits (Crab pulsar)