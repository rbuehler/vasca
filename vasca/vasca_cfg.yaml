---
authors : "UC science"
comment : "Example configuration file"

general:
    name            : "TDS_ELAISN1"
    out_dir_base    : "./examples/vasca_pipeline"        # If "CWD" current work directory will be used.
    log_level       : "DEBUG"                            # ["NONE", "DEBUG", "INFO", "WARNING", "ERROR", "CRITICAL"]
    log_file        : "default"                          # Will be written into "out_dir", if ""default" a default name will be created 
    nr_cpus         : 3                                  # Number of CPUs to use. If "null" all available are used.
    save_ref_srcs   : true                               # Store referenze sources into region file
    
ressources:                      
    load_method      : "MAST_LOCAL"                     # Allowed are ["MAST_REMOTE", "MAST_LOCAL", "VASCA", "AUTO"]
    load_products    :  "ALL"                        # Data products from MAST:  "NONE", "TABLES" for tables and reference image, "ALL" for tables and visit images
    field_kwargs:
        data_path        : null
        visits_data_path : null 

cluster_src:
    meanshift:
        bandwidth     : 3               # In arcsec, to estimate it automatically specify "null"
        seeds         : null
        bin_seeding   : false
        min_bin_freq  : 1
        cluster_all   : true
        n_jobs        : 3
        max_iter      : 300
        table_name    : "tt_sources"

cluster_coadd_dets:
    meanshift:
        bandwidth     : 3               # In arcsec, to estimate it automatically specify "null"
        seeds         : null
        bin_seeding   : false
        min_bin_freq  : 1
        cluster_all   : true
        n_jobs        : 3
        max_iter      : 300
        table_name    : "tt_coadd_detections"

assoc_src_coadd:
    dist_max      : 1        # Associate nearest source below this distance in arc_sec  OR
    dist_s2n_max  : 3        # Associate nearest source with this distance in units of "squared sumed position error"   

        
selection:
    src_variability:
        table       : "tt_sources"
        presel_type : "and"
        sel_type    : "and"
        obs_filter  : "NUV"                             # Select filter to apply cut on, see vasca.utils.dd_filter_id for definitions
        range:
            nr_det         : [2,.inf]
            pos_cpval      : [0.0000000001,.inf]            
            flux_cpval     : [-0.5,0.000000573303]  # 5 sigma, see https://en.wikipedia.org/wiki/Normal_distribution
            flux_nxv       : [0.0006,.inf]          # Excess variance above ~sqrt(cut)*100%  
            flux           : [0.144543,575.43]      # Flux in 1e-6Jy, mag 17-26, see conversion table to AB magnitudes at the end
    src_coadd_diff:
        table       : "tt_sources"
        presel_type : "or"
        sel_type    : "and"
        range:
            nr_det          : [1,.inf]   
            assoc_ffactor   : [2.0,.inf]
            assoc_fdiff_s2n : [7,.inf]

#obs_filters: ["NUV","FUV"]                              # Predefine filters to be used
                    
observations:
  - observatory   : "GALEX"
    obs_filter    : "NUV"
    cluster_det:
        meanshift:
            bandwidth     : 5               # In arcsec, to estimate it automatically specify "null"
            seeds         : null
            bin_seeding   : false
            min_bin_freq  : 1
            cluster_all   : true
            n_jobs        : null
            max_iter      : 300
            table_name    : "tt_detections"

    selection:
        det_quality:
            table       : "tt_detections"
            presel_type : "and"
            sel_type    : "and"
            # See variable description http://www.galex.caltech.edu/wiki/Public:Documentation/Appendix_A.1
            range:
                s2n            : [3.5,.inf]
                r_fov          : [0.0,0.55]
                class_star     : [0.6,1.0]        # Extension classifier (extended=0, point like=1)
                chkobj_type    : [-0.5,0.5]       # Matched to a bright star (0=no, 1=yes)
            bitmask:
                # Specify the artifacts to remove
                # For GALEX a description is at the end of this document
                artifacts : [1,2,4,8,128]
            #If below/above this value will set it to min/max
            set_range:
                pos_err : [0.5,5] # In arcsec
        det_association :
            table       : "tt_detections"
            ref_table   : "tt_sources"
            presel_type : "and"
            sel_type    : "is_in"
            var         : "fd_src_id"
        coadd_det_quality:
            table    : "tt_coadd_detections"
            presel_type : "and"
            sel_type : "and"  # These are all AND selections
            range:
                s2n            : [4,.inf]
                r_fov          : [0.0,0.55]
            
    obs_field_ids :
        # All TDS fields
        # - 2592597978464124928  #PS_XMMLSS_MOS00
        # - 2592668347208302592  #PS_XMMLSS_MOS01
        # - 2592738715952480256  #PS_XMMLSS_MOS02
        # - 2592809084696657920  #PS_XMMLSS_MOS03
        # - 2592879453440835584  #PS_XMMLSS_MOS04
        # - 2592949822185013248  #PS_XMMLSS_MOS05
        # - 2593020190929190912  #PS_XMMLSS_MOS06
        # - 2593653509626789888  #PS_CDFS_MOS00
        # - 2593723878370967552  #PS_CDFS_MOS01
        # - 2593794247115145216  #PS_CDFS_MOS02
        # - 2593864615859322880  #PS_CDFS_MOS03
        # - 2593934984603500544  #PS_CDFS_MOS04
        # - 2594005353347678208  #PS_CDFS_MOS05
        # - 2594075722091855872  #PS_CDFS_MOS06
        - 2597312684324028416  #PS_ELAISN1_MOS10
        - 2597383053068206080  #PS_ELAISN1_MOS11
        - 2597453421812383744  #PS_ELAISN1_MOS12
        - 2597523790556561408  #PS_ELAISN1_MOS13
        - 2597594159300739072  #PS_ELAISN1_MOS14
        - 2597664528044916736  #PS_ELAISN1_MOS15
        - 2597734896789094400  #PS_ELAISN1_MOS16
        # - 2597875634277449728  #PS_VVDS22H_MOS00
        # - 2597946003021627392  #PS_VVDS22H_MOS01
        # - 2598016371765805056  #PS_VVDS22H_MOS02
        # - 2598086740509982720  #PS_VVDS22H_MOS03
        # - 2598157109254160384  #PS_VVDS22H_MOS04
        # - 2598227477998338048  #PS_VVDS22H_MOS05
        # - 2598297846742515712  #PS_VVDS22H_MOS06
        # - 2604912508670050304  #PS_COSMOS_MOS21
        # - 2604982877414227968  #PS_COSMOS_MOS22
        # - 2605053246158405632  #PS_COSMOS_MOS23
        # - 2605123614902583296  #PS_COSMOS_MOS24
        # - 2605193983646760960  #PS_COSMOS_MOS25
        # - 2605264352416104448  #PS_COSMOS_MOS26
        # - 2605334721135116288  #PS_COSMOS_MOS27
        # - 2607023571020546048  #PS_GROTH_MOS01
        # - 2607093939764723712  #PS_GROTH_MOS02
        # - 2607164308508901376  #PS_GROTH_MOS03
        # - 2607234677253079040  #PS_GROTH_MOS04
        # - 2607305045997256704  #PS_GROTH_MOS05
        # - 2607375414741434368  #PS_GROTH_MOS06
        # - 2607445783485612032  #PS_GROTH_MOS07
  - observatory   : "GALEX"
    obs_filter    : "FUV"
    cluster_det:
        meanshift:
            bandwidth     : 4               # In arcsec, to estimate it automatically specify "null"
            seeds         : null
            bin_seeding   : false
            min_bin_freq  : 1
            cluster_all   : true
            n_jobs        : null
            max_iter      : 300
            table_name    : "tt_detections"

    selection:
        det_quality:
            table       : "tt_detections"
            presel_type : "and"
            sel_type    : "and"
            # See variable description http://www.galex.caltech.edu/wiki/Public:Documentation/Appendix_A.1
            range:
                s2n            : [3.5,.inf]
                r_fov          : [0.0,0.55]
                class_star     : [0.6,1.0]        # Extension classifier (extended=0, point like=1)
                chkobj_type    : [-0.5,0.5]       # Matched to a bright star (0=no, 1=yes)
            bitmask:
                # Specify the artifacts to remove
                # For GALEX a description is at the end of this document
                artifacts : [1,2,4,8,128]
            #If below/above this value will set it to min/max
            set_range:
                pos_err : [0.5,5] # In arcsec
        det_association :
            table       : "tt_detections"
            ref_table   : "tt_sources"
            presel_type : "and"
            sel_type    : "is_in"
            var         : "fd_src_id"
        coadd_det_quality:
            table    : "tt_coadd_detections"
            presel_type : "and"
            sel_type : "and"  # These are all AND selections
            range:
                s2n            : [4,.inf]
                r_fov          : [0.0,0.55]
            
    obs_field_ids :
        # All TDS fields
        # - 2592597978464124928  #PS_XMMLSS_MOS00
        # - 2592668347208302592  #PS_XMMLSS_MOS01
        # - 2592738715952480256  #PS_XMMLSS_MOS02
        # - 2592809084696657920  #PS_XMMLSS_MOS03
        # - 2592879453440835584  #PS_XMMLSS_MOS04
        # - 2592949822185013248  #PS_XMMLSS_MOS05
        # - 2593020190929190912  #PS_XMMLSS_MOS06
        # - 2593653509626789888  #PS_CDFS_MOS00
        # - 2593723878370967552  #PS_CDFS_MOS01
        # - 2593794247115145216  #PS_CDFS_MOS02
        # - 2593864615859322880  #PS_CDFS_MOS03
        # - 2593934984603500544  #PS_CDFS_MOS04
        # - 2594005353347678208  #PS_CDFS_MOS05
        # - 2594075722091855872  #PS_CDFS_MOS06
        - 2597312684324028416  #PS_ELAISN1_MOS10
        - 2597383053068206080  #PS_ELAISN1_MOS11
        - 2597453421812383744  #PS_ELAISN1_MOS12
        - 2597523790556561408  #PS_ELAISN1_MOS13
        - 2597594159300739072  #PS_ELAISN1_MOS14
        - 2597664528044916736  #PS_ELAISN1_MOS15
        - 2597734896789094400  #PS_ELAISN1_MOS16
        # - 2597875634277449728  #PS_VVDS22H_MOS00
        # - 2597946003021627392  #PS_VVDS22H_MOS01
        # - 2598016371765805056  #PS_VVDS22H_MOS02
        # - 2598086740509982720  #PS_VVDS22H_MOS03
        # - 2598157109254160384  #PS_VVDS22H_MOS04
        # - 2598227477998338048  #PS_VVDS22H_MOS05
        # - 2598297846742515712  #PS_VVDS22H_MOS06
        # - 2604912508670050304  #PS_COSMOS_MOS21
        # - 2604982877414227968  #PS_COSMOS_MOS22
        # - 2605053246158405632  #PS_COSMOS_MOS23
        # - 2605123614902583296  #PS_COSMOS_MOS24
        # - 2605193983646760960  #PS_COSMOS_MOS25
        # - 2605264352416104448  #PS_COSMOS_MOS26
        # - 2605334721135116288  #PS_COSMOS_MOS27
        # - 2607023571020546048  #PS_GROTH_MOS01
        # - 2607093939764723712  #PS_GROTH_MOS02
        # - 2607164308508901376  #PS_GROTH_MOS03
        # - 2607234677253079040  #PS_GROTH_MOS04
        # - 2607305045997256704  #PS_GROTH_MOS05
        # - 2607375414741434368  #PS_GROTH_MOS06
        # - 2607445783485612032  #PS_GROTH_MOS07
  
# List of other fields
# 2552663716076191744 NGS 32 visits
# 2424979629631602688 MIS 5 visits
# 2508155485249601536 DIS 5 visits
# 6388191295067652096 NGC4993-GW170817 2 visits
# 6381787756527353856 AIS_309_1_28 2 visits (Crab pulsar)

# GALEX artifact flags
# ( 1): edge; Detector bevel edge reflection (NUV only).
# ( 2): window; Detector window reflection (NUV only).
# ( 4): dichroic; Dichroic reflection.
# ( 8): varpix; Varible pixel based on time slices.
# ( 16): brtedge; Bright star near field edge (NUV only)
# ( 32): Detector rim(annulus); proximity(>0.6 deg fld ctr)
# ( 64): dimask; dichroic reflection artifact mask flag
# (128): varmask; Masked pixel determined by varpix.
# (256): hotmask; Detector hot spots.
# (512): yaghost; Possible ghost image from YA slope.
# http://www.galex.caltech.edu/wiki/GCAT_Manual#Flags

# mag(AB)	flux 1e-06 Jy
# 14.0	9120.108393559061
# 15.0	3630.7805477010033
# 16.0	1445.4397707459225
# 17.0	575.4399373371544
# 18.0	229.0867652767766
# 19.0	91.20108393559062
# 20.0	36.307805477010035
# 21.0	14.454397707459224
# 22.0	5.754399373371545
# 23.0	2.290867652767761
# 24.0	0.9120108393559042
# 25.0	0.36307805477010036
# 26.0	0.14454397707459224
# 27.0	0.05754399373371544
