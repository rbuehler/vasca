<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Pipeline" href="tutorial_pipe.html" /><link rel="prev" title="MAST Download" href="tutorial_mast.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.08.06 -->
        <title>Variability Statistics - VASCA v1.0.16dev</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">VASCA v1.0.16dev</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/VASCA_icon.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">VASCA v1.0.16dev</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../user_guide/index.html">User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/data_model.html">Data Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/pipeline.html">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/post_processing.html">Post-Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/instruments.html">Supported Instruments</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/vasca/vasca.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vasca</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of vasca</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/vasca/vasca.region.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vasca.region</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/vasca/vasca.visualization.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vasca.visualization</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/vasca/vasca.utils.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vasca.utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/vasca/vasca.columns.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vasca.columns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/vasca/vasca.field.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vasca.field</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/vasca/vasca.tables_dict.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vasca.tables_dict</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/vasca/vasca.resource_manager.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vasca.resource_manager</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/vasca/vasca.source.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vasca.source</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/vasca/vasca.vasca_pipe.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vasca.vasca_pipe</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/vasca/vasca.tables.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vasca.tables</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial_rm.html">Resource Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_gal_vis.html">GALEX Visits</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_field.html">GALEXField</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_mast.html">MAST Download</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Variability Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_pipe.html">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="simple_example.html">Test Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_table.html">Table Display</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rbuehler/vasca">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/vasca">PyPi</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">See Also</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="http://www.galex.caltech.edu">GALEX</a></li>
<li class="toctree-l1"><a class="reference external" href="https://archive.stsci.edu/missions-and-data/galex">GALEX MAST</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mast.stsci.edu/portal/Mashup/Clients/Mast/Portal.html">MAST Portal</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.weizmann.ac.il/ultrasat/">ULTRASAT</a></li>
<li class="toctree-l1"><a class="reference external" href="http://ilariacaiazzo.com/uv-club/">UV Club</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/rbuehler/vasca/blob/main/docs/tutorials/tutorial_var_stats.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/rbuehler/vasca/edit/main/docs/tutorials/tutorial_var_stats.md" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="variability-statistics">
<h1>Variability Statistics<a class="headerlink" href="#variability-statistics" title="Link to this heading">¶</a></h1>
<p>This tutorial showcases VASCA’s main statistics computation (<a class="reference internal" href="../api/vasca/vasca.utils.html#vasca.utils.get_var_stat" title="vasca.utils.get_var_stat"><code class="xref myst py py-func docutils literal notranslate"><span class="pre">get_var_stat</span></code></a>) based
on synthetic data. The simple simulation framework allows for the variation of data
points, flux uncertainties, number of flare events as well as intrinsic variability
parameters like amplitude and period.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pformat</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_var_stat</span><span class="p">(</span><span class="n">vals</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">vals_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate variability parameters for a set of measurements</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    vals: array-like</span>
<span class="sd">        Variable values (e.g., flux measurements)</span>
<span class="sd">    vals_err: array-like</span>
<span class="sd">        Variable errors (uncertainties in measurements)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        Dictionary containing variability statistics:</span>
<span class="sd">        - wght_mean: Weighted mean of the measurements</span>
<span class="sd">        - wght_mean_err: Error in the weighted mean</span>
<span class="sd">        - var: Sample variance</span>
<span class="sd">        - nxv: Normalized excess variance</span>
<span class="sd">        - rchiq: Reduced chi-square statistic</span>
<span class="sd">        - cpval: Chi-square p-value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
    <span class="n">vals_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals_err</span><span class="p">)</span>

    <span class="n">rr</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">wght</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">vals_err</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">rr</span><span class="p">[</span><span class="s2">&quot;wght_mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">wght</span><span class="p">)</span>
    <span class="n">rr</span><span class="p">[</span><span class="s2">&quot;wght_mean_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">wght</span><span class="p">))</span>

    <span class="n">chiq_el</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">vals</span> <span class="o">-</span> <span class="n">rr</span><span class="p">[</span><span class="s2">&quot;wght_mean&quot;</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">vals_err</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">chiq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">chiq_el</span><span class="p">)</span>
    <span class="n">nr_vals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">nr_vals</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">rr</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">rr</span><span class="p">[</span><span class="s2">&quot;nxv&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">rr</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vals_err</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">rr</span><span class="p">[</span><span class="s2">&quot;wght_mean&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">rr</span><span class="p">[</span><span class="s2">&quot;wght_mean&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">rr</span><span class="p">[</span><span class="s2">&quot;rchiq&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chiq</span> <span class="o">/</span> <span class="p">(</span><span class="n">nr_vals</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">rr</span><span class="p">[</span><span class="s2">&quot;cpval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">chiq</span><span class="p">,</span> <span class="n">nr_vals</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rr</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rr</span><span class="p">[</span><span class="s2">&quot;nxv&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span>
        <span class="n">rr</span><span class="p">[</span><span class="s2">&quot;rchiq&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rr</span><span class="p">[</span><span class="s2">&quot;cpval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>

    <span class="k">return</span> <span class="n">rr</span>
</pre></div>
</div>
</div>
</div>
<section id="synthetic-light-curves">
<h2>Synthetic Light Curves<a class="headerlink" href="#synthetic-light-curves" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">SimulationParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for stellar variability simulation&quot;&quot;&quot;</span>

    <span class="n">n_points</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">base_flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1000.0</span>
    <span class="n">measurement_error_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span>
    <span class="c1"># Periodic variation parameters</span>
    <span class="n">period</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">amplitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Flare parameters</span>
    <span class="n">n_flares</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">flare_amplitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">flare_decay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="c1"># Trend parameters</span>
    <span class="n">slope</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simulate_stellar_light_curve</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">SimulationParams</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    General function to simulate various types of stellar light curves</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    params : SimulationParams</span>
<span class="sd">        Configuration dataclass containing all simulation parameters</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        (times, fluxes, flux_errors) arrays</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate time array</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">params</span><span class="o">.</span><span class="n">n_points</span><span class="p">)</span>

    <span class="c1"># Initialize base flux and measurement errors</span>
    <span class="n">flux_errors</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">params</span><span class="o">.</span><span class="n">base_flux</span> <span class="o">*</span> <span class="n">params</span><span class="o">.</span><span class="n">measurement_error_fraction</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">n_points</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">fluxes</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">base_flux</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">n_points</span><span class="p">)</span>

    <span class="c1"># Add periodic variations if specified</span>
    <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">period</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">params</span><span class="o">.</span><span class="n">amplitude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">times</span> <span class="o">/</span> <span class="n">params</span><span class="o">.</span><span class="n">period</span>
        <span class="n">fluxes</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">params</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span>

    <span class="c1"># Add flares if specified</span>
    <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">n_flares</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">params</span><span class="o">.</span><span class="n">flare_amplitude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flare_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
            <span class="n">params</span><span class="o">.</span><span class="n">n_points</span><span class="p">,</span> <span class="n">params</span><span class="o">.</span><span class="n">n_flares</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">flare_indices</span><span class="p">:</span>
            <span class="n">flare_profile</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">flare_amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                <span class="o">-</span><span class="n">params</span><span class="o">.</span><span class="n">flare_decay</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">times</span> <span class="o">-</span> <span class="n">times</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="n">fluxes</span> <span class="o">+=</span> <span class="n">params</span><span class="o">.</span><span class="n">base_flux</span> <span class="o">*</span> <span class="n">flare_profile</span>

    <span class="c1"># Add linear trend if specified</span>
    <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">slope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fluxes</span> <span class="o">+=</span> <span class="n">params</span><span class="o">.</span><span class="n">slope</span> <span class="o">*</span> <span class="n">times</span>

    <span class="c1"># Add measurement noise</span>
    <span class="n">fluxes</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">flux_errors</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">fluxes</span><span class="p">,</span> <span class="n">flux_errors</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predefined scenario configurations</span>
<span class="n">SCENARIOS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Quiet Star&quot;</span><span class="p">:</span> <span class="n">SimulationParams</span><span class="p">(</span><span class="n">measurement_error_fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">),</span>
    <span class="s2">&quot;Pulsating Star&quot;</span><span class="p">:</span> <span class="n">SimulationParams</span><span class="p">(</span>
        <span class="n">period</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">measurement_error_fraction</span><span class="o">=</span><span class="mf">0.03</span>
    <span class="p">),</span>
    <span class="s2">&quot;Flare Star&quot;</span><span class="p">:</span> <span class="n">SimulationParams</span><span class="p">(</span>
        <span class="n">n_flares</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">flare_amplitude</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
        <span class="n">measurement_error_fraction</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span>
        <span class="n">flare_decay</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s2">&quot;Low-Amplitude Variable&quot;</span><span class="p">:</span> <span class="n">SimulationParams</span><span class="p">(</span>
        <span class="n">period</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">measurement_error_fraction</span><span class="o">=</span><span class="mf">0.01</span>
    <span class="p">),</span>
    <span class="s2">&quot;Noisy Variable&quot;</span><span class="p">:</span> <span class="n">SimulationParams</span><span class="p">(</span>
        <span class="n">period</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">measurement_error_fraction</span><span class="o">=</span><span class="mf">0.10</span>
    <span class="p">),</span>
    <span class="s2">&quot;Secular Trend&quot;</span><span class="p">:</span> <span class="n">SimulationParams</span><span class="p">(</span><span class="n">slope</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">measurement_error_fraction</span><span class="o">=</span><span class="mf">0.03</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_custom_scenario</span><span class="p">(</span><span class="n">scenario_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimulationParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a custom scenario by modifying default parameters</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    scenario_type : str</span>
<span class="sd">        Name of the base scenario to modify</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Parameters to override from the base scenario</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SimulationParams</span>
<span class="sd">        Modified simulation parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">scenario_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SCENARIOS</span><span class="p">:</span>
        <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unknown scenario type: </span><span class="si">{</span><span class="n">scenario_type</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># Create new params based on the scenario</span>
    <span class="n">base_params</span> <span class="o">=</span> <span class="n">SCENARIOS</span><span class="p">[</span><span class="n">scenario_type</span><span class="p">]</span>

    <span class="c1"># Create a new instance with updated parameters</span>
    <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">base_params</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="n">param_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SimulationParams</span><span class="p">(</span><span class="o">**</span><span class="n">param_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">AnalysisResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Container for analysis results of a scenario&quot;&quot;&quot;</span>

    <span class="n">scenario_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">times</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">fluxes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">errors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">stats</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="n">interpretation</span><span class="p">:</span> <span class="nb">str</span>


<span class="k">def</span> <span class="nf">analyze_scenario</span><span class="p">(</span><span class="n">scenario_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">SimulationParams</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnalysisResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analyze a single scenario and provide interpretation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate data</span>
    <span class="n">times</span><span class="p">,</span> <span class="n">fluxes</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">simulate_stellar_light_curve</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="c1"># Calculate statistics</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">get_var_stat</span><span class="p">(</span><span class="n">fluxes</span><span class="p">,</span> <span class="n">errors</span><span class="p">)</span>

    <span class="c1"># Generate interpretation based on statistics</span>
    <span class="n">interpretation</span> <span class="o">=</span> <span class="n">interpret_statistics</span><span class="p">(</span><span class="n">scenario_name</span><span class="p">,</span> <span class="n">stats</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">AnalysisResult</span><span class="p">(</span>
        <span class="n">scenario_name</span><span class="o">=</span><span class="n">scenario_name</span><span class="p">,</span>
        <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span>
        <span class="n">fluxes</span><span class="o">=</span><span class="n">fluxes</span><span class="p">,</span>
        <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
        <span class="n">stats</span><span class="o">=</span><span class="n">stats</span><span class="p">,</span>
        <span class="n">interpretation</span><span class="o">=</span><span class="n">interpretation</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">interpret_statistics</span><span class="p">(</span><span class="n">scenario_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stats</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate human-readable interpretation of the statistics</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">interpretations</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Quiet Star&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Non-variable star showing noise-dominated behavior:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Excess variance (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;nxv&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">) near zero as expected</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Reduced χ² (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;rchiq&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">) ≈ 1 indicates good fit to constant flux</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• High p-value (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;cpval&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">) suggests no significant variability&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Pulsating Star&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Clear periodic variability detected:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Strong excess variance (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;nxv&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">) indicates intrinsic variation</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• High reduced χ² (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;rchiq&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">) confirms deviation from constant flux</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Very low p-value (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;cpval&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">) shows high significance&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Flare Star&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Episodic flare behavior detected:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Extreme excess variance (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;nxv&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">) due to flare events</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Very high reduced χ² (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;rchiq&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">) from strong flux excursions</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• P-value (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;cpval&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">) indicates definite variability&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Low-Amplitude Variable&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Subtle variability detected due to precise measurements:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Moderate excess variance (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;nxv&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">) despite low amplitude</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Reduced χ² (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;rchiq&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">) shows clear detection</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Low p-value (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;cpval&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">) confirms significance&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Noisy Variable&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Variability partially masked by measurement errors:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Modest excess variance (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;nxv&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">) due to noise</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Reduced χ² (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;rchiq&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">) near detection threshold</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Marginal p-value (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;cpval&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">) suggests weak detection&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Secular Trend&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Systematic brightness change detected:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• High excess variance (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;nxv&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">) from trend</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Large reduced χ² (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;rchiq&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">) indicates non-constant flux</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;• Very low p-value (</span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;cpval&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">) confirms trend significance&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">interpretations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">scenario_name</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;No interpretation available</span><span class="se">\n</span><span class="si">{</span><span class="n">pformat</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span><span class="w"> </span><span class="n">sort_dicts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">visualize_results</span><span class="p">(</span>
    <span class="n">results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AnalysisResult</span><span class="p">],</span> <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create comprehensive visualization of all scenarios</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_scenarios</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">n_scenarios</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="n">n_scenarios</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Create summary dataframe for statistics</span>
    <span class="n">summary_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
        <span class="c1"># Light curve plot</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
            <span class="n">result</span><span class="o">.</span><span class="n">times</span><span class="p">,</span>
            <span class="n">result</span><span class="o">.</span><span class="n">fluxes</span><span class="p">,</span>
            <span class="n">yerr</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span>
            <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observations&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
            <span class="n">y</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;wght_mean&quot;</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Mean: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;wght_mean&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> ± </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;wght_mean_err&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
            <span class="n">result</span><span class="o">.</span><span class="n">times</span><span class="p">,</span>
            <span class="n">result</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;wght_mean&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">result</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;wght_mean_err&quot;</span><span class="p">],</span>
            <span class="n">result</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;wght_mean&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;wght_mean_err&quot;</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (days)&quot;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Flux&quot;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">scenario_name</span><span class="si">}</span><span class="s2"> Light Curve&quot;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="c1"># Statistics and interpretation text</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="mf">0.95</span><span class="p">,</span>
            <span class="n">result</span><span class="o">.</span><span class="n">interpretation</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
            <span class="n">fontfamily</span><span class="o">=</span><span class="s2">&quot;monospace&quot;</span><span class="p">,</span>
            <span class="n">wrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Collect summary statistics</span>
        <span class="n">summary_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;Scenario&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">scenario_name</span><span class="p">,</span>
                <span class="s2">&quot;Weighted Mean&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;wght_mean&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">±</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;wght_mean_err&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Excess Variance&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;nxv&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Reduced χ²&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;rchiq&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;P-value&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;cpval&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">save_path</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">summary_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Analyze all predefined scenarios</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># For reproducibility</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">scenario_name</span><span class="p">,</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">SCENARIOS</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyze_scenario</span><span class="p">(</span><span class="n">scenario_name</span><span class="p">,</span> <span class="n">params</span><span class="p">))</span>

<span class="c1"># Visualize and get summary</span>
<span class="n">summary_df</span> <span class="o">=</span> <span class="n">visualize_results</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># Display summary table</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variability Analysis Summary:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">summary_df</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variability Analysis Summary:
              Scenario Weighted Mean Excess Variance Reduced χ²   P-value
            Quiet Star     988.7±7.1          -0.000       0.87  7.24e-01
        Pulsating Star    1005.4±4.2           0.021      24.09 5.54e-215
            Flare Star    1509.7±5.7           0.577     822.93  0.00e+00
Low-Amplitude Variable     998.2±1.4           0.000       5.31  1.56e-30
        Noisy Variable   1014.4±14.1           0.015       2.54  1.60e-08
         Secular Trend     949.1±4.2           0.001       2.43  8.91e-08
</pre></div>
</div>
<img alt="../_images/8535c3cdff58cbd32d1b777941e41be353519b317a135d6fbc51fdd0642d5cb6.png" src="../_images/8535c3cdff58cbd32d1b777941e41be353519b317a135d6fbc51fdd0642d5cb6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example of custom scenario analysis</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Flare Star&quot;</span>
<span class="n">custom_params</span> <span class="o">=</span> <span class="n">create_custom_scenario</span><span class="p">(</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">n_points</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">n_flares</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">flare_amplitude</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
    <span class="n">measurement_error_fraction</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
    <span class="n">flare_decay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">custom_result</span> <span class="o">=</span> <span class="n">analyze_scenario</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Custom </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">custom_params</span><span class="p">)</span>
<span class="n">custom_summary</span> <span class="o">=</span> <span class="n">visualize_results</span><span class="p">([</span><span class="n">custom_result</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5938e41b1aeaf5a717eac776176d34987cce1a4eaa9dcd6da8618d3e492b3e15.png" src="../_images/5938e41b1aeaf5a717eac776176d34987cce1a4eaa9dcd6da8618d3e492b3e15.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example of custom scenario analysis</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Pulsating Star&quot;</span>
<span class="n">custom_params</span> <span class="o">=</span> <span class="n">create_custom_scenario</span><span class="p">(</span>
    <span class="n">name</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">measurement_error_fraction</span><span class="o">=</span><span class="mf">0.03</span>
<span class="p">)</span>
<span class="n">custom_result</span> <span class="o">=</span> <span class="n">analyze_scenario</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Custom </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">custom_params</span><span class="p">)</span>
<span class="n">custom_summary</span> <span class="o">=</span> <span class="n">visualize_results</span><span class="p">([</span><span class="n">custom_result</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/29aa90b16bcb4261fed88da76223dd70a474659e838c0e77e01c8a4e7928552a.png" src="../_images/29aa90b16bcb4261fed88da76223dd70a474659e838c0e77e01c8a4e7928552a.png" />
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="tutorial_pipe.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Pipeline</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="tutorial_mast.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">MAST Download</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; BSD 3-Clause License
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/rbuehler/vasca" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Variability Statistics</a><ul>
<li><a class="reference internal" href="#synthetic-light-curves">Synthetic Light Curves</a></li>
<li><a class="reference internal" href="#visualization">Visualization</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=67649a7e"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=6dbb43f8"></script>
    <script defer="defer" src="https://unpkg.com/@popperjs/core@2"></script>
    <script defer="defer" src="https://unpkg.com/tippy.js@6"></script>
    <script defer="defer" src="../_static/tippy/tutorials/tutorial_var_stats.dc80c281-6841-4664-8270-353580de474b.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>